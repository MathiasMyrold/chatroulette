(this.webpackJsonpklient=this.webpackJsonpklient||[]).push([[0],{131:function(n,e,t){"use strict";t.r(e);var r,c,o,i,a,s,u,l,d,b,h,j,f,g,x,p,m=t(0),O=t.n(m),w=t(9),v=t.n(w),k=(t(95),t(23)),y=t(44),C=(t(96),t(8)),D=t(13),S=t(14),I=t(164),E=t(165),R=t(4),T=S.a.div(r||(r=Object(D.a)(["\n  width: 30rem;\n  height: 28rem;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  background: #fff;\n  padding: 3rem;\n  border-radius: 8px;\n"]))),L=function(n){return Object(R.jsxs)(T,{children:[Object(R.jsx)("h1",{children:"Login"}),Object(R.jsx)("hr",{}),Object(R.jsx)(I.a,{style:{width:"100%",marginBottom:24},label:"Username",onChange:n.onChange,onKeyDown:n.onKeyDown,variant:"outlined"}),Object(R.jsx)(E.a,{style:{width:"100%"},variant:"contained",color:"secondary",onClick:n.onLogin,children:"Enter chat room"})]})},K=S.a.div(c||(c=Object(D.a)(["\n  width: 100%;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]))),B=function(){var n=Object(m.useState)(""),e=Object(k.a)(n,2),t=e[0],r=e[1],c=Object(m.useContext)(tn).setAuthState,o=Object(C.f)(),i=function(){c({username:t}),o.push("/chat")};return Object(R.jsx)(K,{children:Object(R.jsx)(L,{onKeyDown:function(n){13===n.keyCode&&i()},onLogin:i,onChange:function(n){r(n.target.value)}})})},U=t(57),A=t(85),M=t.n(A),N=S.a.div(o||(o=Object(D.a)(["\n  //border-right: ridge grey 1px;\n  max-width: 60%;\n  min-height: 100%;\n  border-radius: 0px;\n  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n\n"]))),H=(S.a.input(i||(i=Object(D.a)(["\n  min-height: 25px;\n  min-width: 250px;\n  display: block;\n  margin: auto;\n  margin-top: 15px;\n  border-radius: 50px;\n"]))),S.a.div(a||(a=Object(D.a)(["\n  margin-top: 20px;\n  padding:5px;\n  margin:10px;\n  font-size:25px;\n  \n"])))),z=(S.a.div(s||(s=Object(D.a)(["\n  background-color: black;\n  width: 100px;\n"]))),S.a.div(u||(u=Object(D.a)(["\n  width: wrap;\n  margin: 4px;\n  padding-left: 5px;\n  user-select: none;\n  &:hover{\n    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);\n    box-shadow: inset 0 0 6px rgba(0,0,0,0.3);\n    border-radius:10px;\n  } ;\n  &:active{\n    -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.6);\n    box-shadow: inset 0 0 6px rgba(0,0,0,0.6);\n  }\n"])))),J=function(n){var e=n.users,t=n.onUserClick,r=Object(m.useState)(""),c=Object(k.a)(r,2),o=c[0],i=c[1];return Object(R.jsxs)(N,{children:[Object(R.jsx)(I.a,{onChange:function(n){return i(n.target.value)},placeholder:"Search",style:{width:"80%",marginTop:"5px",marginLeft:"3px",minHeight:"20px",color:"white"}}),Object(R.jsxs)(H,{children:[Object(R.jsx)("b",{children:"Brukerne:"})," ",Object(R.jsx)("br",{}),e.filter((function(n){return""==o||null!=n.name&&n.name.toLowerCase().includes(o.toLocaleLowerCase())?n:void 0})).map((function(n){return Object(R.jsx)(z,{onClick:function(){return t(n)},children:n.name},n.id)}))]})]})},P=t(163),G=S.a.div(l||(l=Object(D.a)(["\n  height: 100vh;\n  width: 100%;\n"]))),q=(S.a.div(d||(d=Object(D.a)(["\n  position: right;\n  width: 70%;\n  height: relative;\n  background-color: white;\n  margin: 3px;\n"]))),S.a.fieldset(b||(b=Object(D.a)(["\n  position: left;\n  float:right;\n  width: 50%;\n  height: relative;\n  padding: 5px;\n  background-color: none;\n  margin: 3px;\n  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  border-radius: 10px;\n"])))),F=S.a.fieldset(h||(h=Object(D.a)(["\n  position: left;\n  float:left;\n  width: 50%;\n  height: relative;\n  padding: 5px;\n  background-color: blue;\n  margin: 3px;\n  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  border-radius: 10px;\n"]))),Q=S.a.div(j||(j=Object(D.a)([""]))),V=(S.a.div(f||(f=Object(D.a)(["\n  font-size: small;\n  \n"]))),S.a.div(g||(g=Object(D.a)(["\n  color: white;\n  width: 100%;\n  \n  height: 40vh;\n  overflow: hidden;\n  overflow-y: scroll;\n  ::-webkit-scrollbar {\n    width: 20px;\n  }\n  ::-webkit-scrollbar-track {\n    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n    box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n    border-radius: 10px;\n  }\n  ::-webkit-scrollbar-thumb {\n    -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n    box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n    border-radius: 10px;\n  }\n  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n  border-radius: 10px;\n"])))),W=S.a.div(x||(x=Object(D.a)(["\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 80%;\n  padding: 3rem;\n\n\n"]))),X=S.a.h2(p||(p=Object(D.a)(["\n  text-align: left;\n  margin: 0px;\n  color: white;\n"])));function Y(n,e,t,r,c){var o=Z(t,r),i=Z(t,c);return setTimeout((function(){document.getElementById("hei").scrollTop=document.getElementById("hei").scrollHeight}),1),n.yours?(console.log("min melding"),Object(R.jsxs)(q,{children:[Object(R.jsx)("legend",{children:i}),n.value]},e)):Object(R.jsxs)(F,{children:[Object(R.jsx)("legend",{children:o}),n.value]},e)}function Z(n,e){var t="";return n.forEach((function(n){n.id==e&&(t=n.name)})),t}var $=function(n){var e=n.users,t=n.messages,r=n.text,c=n.onUserClick,o=n.handleChange,i=n.sendMessage,a=n.onKeyDown,s=n.otherUser,u=n.myID;return Object(R.jsx)(G,{children:Object(R.jsxs)(P.a,{className:"h100",container:!0,children:[Object(R.jsx)(P.a,{item:!0,md:4,children:Object(R.jsx)(J,{users:e,onUserClick:function(n){return c(n)}})}),Object(R.jsx)(P.a,{item:!0,md:8,children:Object(R.jsxs)(W,{children:[Object(R.jsx)(X,{children:Object(R.jsxs)("p",{children:["Du snakker med ",Z(e,s)]})}),Object(R.jsx)(V,{id:"hei",children:t.map((function(n,t){return Y(n,t,e,s,u)}))}),Object(R.jsxs)(Q,{children:[Object(R.jsx)(I.a,{style:{width:"100%",marginBottom:24,background:"#fff"},label:"ENTER MESSAGE",variant:"outlined",value:r,onChange:o,onKeyDown:a}),Object(R.jsx)(E.a,{style:{width:"100%"},variant:"contained",color:"secondary",onClick:i,children:"Send Message"})]})]})})]})})},_=t(166),nn=function(){var n=Object(C.f)(),e=Object(m.useState)([]),t=Object(k.a)(e,2),r=t[0],c=t[1],o=Object(m.useContext)(tn).authState,i=Object(m.useRef)(),a=Object(m.useRef)(),s=Object(m.useRef)(),u=Object(m.useRef)(),l=Object(m.useRef)(),d=Object(m.useState)(""),b=Object(k.a)(d,2),h=b[0],j=b[1],f=Object(m.useState)([]),g=Object(k.a)(f,2),x=g[0],p=g[1],O=Object(m.useRef)();Object(m.useEffect)((function(){a.current=M()("/",{transports:["websocket","polling"]}),a.current.on("connect",(function(){O.current=a.current.id,a.current.emit("username",o.username)})),a.current.on("users",(function(n){c(n),console.log(n)})),a.current.on("connected",(function(n){console.log(n.name+" conneceted")})),a.current.on("disconnected",(function(n){console.log("disconnected:"+n),u.current==n&&a.current.emit("forlat",a.current.id),c((function(e){return e.filter((function(e){return e.id!==n}))}))})),a.current.on("romInvitasjon",(function(e){!function(e,t,r){try{var c=window.confirm(r+" vil snakke med deg!\nTrykk OK for \xe5 godta, og Avbryt for \xe5 avsl\xe5");if(c){null!=u.current&&a.current.emit("forlat",u.current),l.current=r,u.current=t,n.push("/chat/".concat(e)),function(n){p([]),s.current=S(n);var e=Object(_.a)();i.current=s.current.createDataChannel("sendChannel"+e),i.current.onopen=D,i.current.onmessage=I}(t);var o={id:e,from:t};a.current.emit("akseptert",o)}else c?console.log("Noe gikk galt"):a.current.emit("avslaa",t)}catch(d){console.log(d.message)}}(e.romID,e.from,e.name)})),a.current.on("akseptert",(function(e){!function(e){p([]),n.push("/chat/".concat(e))}(e)})),a.current.on("forlot",v),a.current.on("avslaatt",y),a.current.on("offer",T),a.current.on("answer",L),a.current.on("ice-candidate",B)}),[]);var w=function(n){if(n.id!==a.current.id){u.current=n.id,console.log("USER CLCKED",n);var e=Object(_.a)(),t={target:n.id,from:a.current.id,romID:e,name:o.username};a.current.emit("roomID",t)}else console.log("Du kan ikke snakke med deg selv")};function v(){alert(l.current+" forlot samtalen"),p([]),n.push("/chat"),l.current=null,u.current=null}function y(){alert("Kunne ikke akseptere")}function D(){console.log("onopen")}function S(n){var e=new RTCPeerConnection({iceServers:[{urls:"stun:stun.stunprotocol.org"}]});return e.onicecandidate=K,e.onnegotiationneeded=function(){return function(n){s.current.createOffer().then((function(n){return console.log(n),s.current.setLocalDescription(n)})).then((function(){var e={target:n,caller:a.current.id,sdp:s.current.localDescription};a.current.emit("offer",e)})).catch((function(n){return console.log(n)}))}(n)},e}function I(n){p((function(e){return[].concat(Object(U.a)(e),[{yours:!1,value:n.data}])}))}function E(){h.length&&(i.current.send(h),p((function(n){return[].concat(Object(U.a)(n),[{yours:!0,value:h}])})),j("")),setTimeout((function(){document.getElementById("hei").scrollTop=document.getElementById("hei").scrollHeight}),1)}function T(n){s.current=S(),s.current.ondatachannel=function(n){i.current=n.channel,i.current.onopen=D,i.current.onmessage=I};var e=new RTCSessionDescription(n.sdp);s.current.setRemoteDescription(e).then((function(){})).then((function(){return s.current.createAnswer()})).then((function(n){return console.log(n),s.current.setLocalDescription(n)})).then((function(){var e={target:n.caller,caller:a.current.id,sdp:s.current.localDescription};a.current.emit("answer",e)}))}function L(n){var e=new RTCSessionDescription(n.sdp);console.log("svar: "+e),s.current.setRemoteDescription(e).catch((function(n){return console.log(n)}))}function K(n){if(console.log("Ice candidate"),n.candidate){var e={target:u.current,candidate:n.candidate};a.current.emit("ice-candidate",e)}}function B(n){var e=new RTCIceCandidate(n);s.current.addIceCandidate(e).catch((function(n){return console.log(n)}))}return Object(R.jsx)($,{users:r,messages:x,text:h,onUserClick:function(n){return w(n)},handleChange:function(n){return function(n){j(n.target.value)}(n)},sendMessage:E,onKeyDown:function(n){13===n.keyCode&&E()},otherUser:u.current,myID:O.current})},en=Object(R.jsxs)(C.c,{children:[Object(R.jsx)(C.a,{exact:!0,path:"/",component:B}),Object(R.jsx)(C.a,{exact:!0,path:"/chat",component:nn}),Object(R.jsx)(C.a,{exact:!0,path:"/chat/:roomID",component:nn})]}),tn=Object(m.createContext)({authState:null,setAuthState:function(){}});var rn=function(){var n=Object(m.useState)({username:null}),e=Object(k.a)(n,2),t=e[0],r=e[1];return Object(R.jsx)(y.a,{children:Object(R.jsx)("div",{className:"App",children:Object(R.jsx)(tn.Provider,{value:{authState:t,setAuthState:r},children:en})})})};v.a.render(Object(R.jsx)(O.a.StrictMode,{children:Object(R.jsx)(rn,{})}),document.getElementById("root"))},95:function(n,e,t){},96:function(n,e,t){}},[[131,1,2]]]);
//# sourceMappingURL=main.765ec4d4.chunk.js.map